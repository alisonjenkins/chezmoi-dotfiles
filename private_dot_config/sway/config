# This file has been auto-generated by i3-config-wizard(1).
# It will not be overwritten, so edit it as you like.
#
# Should you change your keyboard layout some time, delete
# this file and re-run i3-config-wizard(1).
#

# i3 config file (v4)
#
# Please see http://i3wm.org/docs/userguide.html for a complete reference!

set $mod Mod4

# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below.
font pango:monospace 0

# Hide window bars
default_border pixel 1

# This font is widely installed, provides lots of unicode glyphs, right-to-left
# text rendering and scalability on retina/hidpi displays (thanks to pango).
#font pango:DejaVu Sans Mono 8

# Monokai Colour Scheme

set $base00 #272822
set $base01 #383830
set $base02 #49483e
set $base03 #75715e
set $base04 #a59f85
set $base05 #f8f8f2
set $base06 #f5f4f1
set $base07 #f9f8f5
set $base08 #f92672
set $base09 #fd971f
set $base0A #f4bf75
set $base0B #a6e22e
set $base0C #a1efe4
set $base0D #66d9ef
set $base0E #ae81ff
set $base0F #cc6633

# Window border colour scheme
# Basic color configuration using the Base16 variables for windows and borders.
# Property Name         Border  BG      Text    Indicator Child Border
# client.focused          #000000 #000000 #888888 #000000         #000000
# client.focused_inactive $base01 $base01 $base05 $base03         $base01
# client.unfocused        $base01 $base00 $base05 $base01         $base01
# client.urgent           $base08 $base08 $base00 $base08         $base08
# client.placeholder      $base00 $base00 $base05 $base00         $base00
# client.background       $base07

# Hide window titles (handled by Polybar instead)
for_window [class="^.*"] border pixel 0

# i3 gaps specific config
smart_borders on
gaps inner 2
gaps outer 2

# Solarized dark
#client.focused          #000000 #586e75 #fdf6e3 #268bd2
#client.focused_inactive #000000 #073642 #839496 #073642
#client.unfocused        #000000 #073642 #839496 #073642
#client.urgent           #000000 #dc322f #fdf6e3 #002b36

# Before i3 v4.8, we used to recommend this one as the default:
# font -misc-fixed-medium-r-normal--13-120-75-75-C-70-iso10646-1
# The font above is very space-efficient, that is, it looks good, sharp and
# clear in small sizes. However, its unicode glyph coverage is limited, the old
# X core fonts rendering does not support right-to-left and this being a bitmap
# font, it doesn’t scale on retina/hidpi displays.

# workspace monitor configuration
workspace 2 output DP1
workspace 3 output DP1
workspace 4 output DP1
workspace 5 output DP1
workspace 6 output DP1
workspace 7 output DP1
workspace 8 output DP1
workspace 9 output DP1

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

hide_edge_borders smart
popup_during_fullscreen leave_fullscreen
workspace_auto_back_and_forth yes

# start a terminal
bindsym $mod+Return exec kitty --single-instance --session ~/.config/kitty/session-tmux.conf
bindsym $mod+Shift+Return exec kitty

# kill focused window
bindsym $mod+Shift+q kill

# start dmenu (a program launcher)
#bindsym $mod+d exec j4-dmenu-desktop --dmenu='rofi -dmenu -i' --term=termite --usage-log=~/.config/j4-dmenu-desktop/usage-log.txt
# bindsym $mod+d exec rofi -show drun -show-icons -matching fuzzy -theme ~/.config/rofi/themes/solarized_alternate.rasi -location 2
bindsym $mod+d exec rofi -show drun -show-icons -matching fuzzy -theme ~/.config/rofi/themes/onedark.rasi -location 2
# There also is the (new) i3-dmenu-desktop which only displays applications
# shipping a .desktop file. It is a wrapper around dmenu, so you need that
# installed.
# bindsym $mod+d exec --no-startup-id i3-dmenu-desktop

# change focus
bindsym $mod+j focus left
bindsym $mod+k focus down
bindsym $mod+l focus up
bindsym $mod+semicolon focus right

# alternatively, you can use the cursor keys:
bindsym $mod+comma workspace prev
bindsym $mod+period workspace next

# move focused window
bindsym $mod+Shift+j move left
bindsym $mod+Shift+k move down
bindsym $mod+Shift+l move up
bindsym $mod+Shift+semicolon move right

# alternatively, you can use the cursor keys:
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# split in horizontal orientation
bindsym $mod+h split h

# split in vertical orientation
bindsym $mod+v split v

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# focus the parent container
bindsym $mod+a focus parent

# focus the child container
#bindsym $mod+d focus child

# switch to workspace
bindsym $mod+1 workspace 1
bindsym $mod+2 workspace 2
bindsym $mod+3 workspace 3
bindsym $mod+4 workspace 4
bindsym $mod+5 workspace 5
bindsym $mod+6 workspace 6
bindsym $mod+7 workspace 7
bindsym $mod+8 workspace 8
bindsym $mod+9 workspace 9
bindsym $mod+0 workspace 10

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace 1
bindsym $mod+Shift+2 move container to workspace 2
bindsym $mod+Shift+3 move container to workspace 3
bindsym $mod+Shift+4 move container to workspace 4
bindsym $mod+Shift+5 move container to workspace 5
bindsym $mod+Shift+6 move container to workspace 6
bindsym $mod+Shift+7 move container to workspace 7
bindsym $mod+Shift+8 move container to workspace 8
bindsym $mod+Shift+9 move container to workspace 9
bindsym $mod+Shift+0 move container to workspace 10

# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+r restart
# exit i3 (logs you out of your X session)
bindsym $mod+Shift+e exec "i3-nagbar -t warning -m 'You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.' -b 'Yes, exit i3' 'i3-msg exit'"

# resize window (you can also use the mouse for that)
mode "resize" {
        # These bindings trigger as soon as you enter the resize mode

        # Pressing left will shrink the window’s width.
        # Pressing right will grow the window’s width.
        # Pressing up will shrink the window’s height.
        # Pressing down will grow the window’s height.
        bindsym j resize shrink width 10 px or 10 ppt
        bindsym k resize grow height 10 px or 10 ppt
        bindsym l resize shrink height 10 px or 10 ppt
        bindsym semicolon resize grow width 10 px or 10 ppt

        # same bindings, but for the arrow keys
        bindsym Left resize shrink width 10 px or 10 ppt
        bindsym Down resize grow height 10 px or 10 ppt
        bindsym Up resize shrink height 10 px or 10 ppt
        bindsym Right resize grow width 10 px or 10 ppt

        # back to normal: Enter or Escape
        bindsym Return mode "default"
        bindsym Escape mode "default"
}

bindsym $mod+r mode "resize"

# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
# bar {
#   # status_command /usr/bin/waybar
#   # mode hide
#   # hidden_state hide

#   # colors {
#   #   background $base00
#   #   separator  $base01
#   #   statusline $base04

#   #   # State             Border  BG      Text
#   #   focused_workspace   $base05 $base0D $base00
#   #   active_workspace    $base05 $base03 $base00
#   #   inactive_workspace  $base03 $base01 $base05
#   #   urgent_workspace    $base08 $base08 $base00
#   #   binding_mode        $base00 $base0A $base00
#   # }

#   # Solarized Dark
#   colors {
#     background #002b36
#     statusline #839496
#     separator  #586e75
#     focused_workspace  #b58900 #b58900 #002b36
#     active_workspace   #586e75 #586e75 #002b36
#     inactive_workspace #073642 #002b36 #839496
#     urgent_workspace   #dc322f #dc322f #fdf6e3
#   }
# }

set $mode_system System (l) lock, (e) logout, (s) suspend, (h) hibernate, (r) reboot, (Shift+s) shutdown
mode "$mode_system" {
    bindsym l exec screen-lock mode "default"
    bindsym e exec swaymsg logout, mode "default"
    bindsym s exec sudo systemctl suspend, mode "default"
    bindsym h exec sudo systemctl hibernate, mode "default"
    bindsym r exec sudo systemctl reboot, mode "default"
    bindsym Shift+s exec sudo systemctl shutdown, mode "default"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+Delete mode "$mode_system"


set $mode_network Start Bashton VPN (v)
mode "$mode_network" {
    bindsym v exec --no-startup-id tmux new-session -d -s "openvpn" "pkexec openvpn /home/alan/.cert/alan.conf", mode "default"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+Shift+n mode "$mode_network"

set $mode_monitor System (w) work, (h) home, (l) laptop
mode "$mode_monitor" {
    bindsym w exec --no-startup-id "xrandr --output eDP-1 --mode 3200x1800 --output DP-1 --mode 3840x2160 --right-of eDP-1 ; /home/alan/.config/polybar/launch.sh"
    bindsym h exec --no-startup-id "xrandr --output eDP-1-1 --mode 1920x1080 -r 144 --output DP-0 --mode 3440x1440 -r 100 --right-of eDP-1-1 --primary ; /home/alan/.config/polybar/launch.sh"
    bindsym l exec --no-startup-id "xrandr --output eDP-1 --mode 3200x1800 --output DP-1 --off ; /home/alan/.config/polybar/launch.sh"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+Shift+Mod1+m mode "$mode_monitor"
# bindsym Hyper+m exec --no-startup-id i3-msg "workspace 2; move workspace to DP-1; workspace 3; move workspace to DP-1; workspace 10; move workspace to DP-1; workspace 1;"

# Screenshot mode
set $mode_screenshot Active window to clipboard (a), Active window to file (A), Screen to clipboard (s), Screen to file (S), Selected rectangle to clipboard (r), Selected rectangle to file (R), Active monitor (m), Active monitor to file (M)
mode "$mode_screenshot" {
    bindsym a exec --no-startup-id  ~/.config/i3/scripts/screenshot/active_window.sh -clipboard
    bindsym Shift+a exec --no-startup-id  ~/.config/i3/scripts/screenshot/active_window.sh

    bindsym s exec --no-startup-id ~/.config/i3/scripts/screenshot/screen.sh -clipboard
    bindsym Shift+s exec --no-startup-id ~/.config/i3/scripts/screenshot/screen.sh

    bindsym r exec --no-startup-id ~/.config/i3/scripts/screenshot/rectangle.sh -clipboard
    bindsym Shift+r exec --no-startup-id ~/.config/i3/scripts/screenshot/rectangle.sh

    bindsym m exec --no-startup-id ~/.config/i3/scripts/screenshot/monitor.sh -clipboard
    bindsym Shift+m exec --no-startup-id ~/.config/i3/scripts/screenshot/monitor.sh

    bindsym g exec --no-startup-id ~/.config/i3/scripts/screenshot/gif.sh -clipboard
    bindsym Shift+g exec --no-startup-id ~/.config/i3/scripts/screenshot/gif.sh

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym Print mode "$mode_screenshot"

set $mode_paste Convert sensu intance ID (s)
mode "$mode_paste" {
    # Convert sensu url in clipboard to instance ID and put the ID back in the clipboard.
    bindsym s exec --no-startup-id xclip -o -sel clipboard | sed 's/http:\/\///g' | sed 's/\///g' | sed 's/^.*-//g' | cut -d'.' -f 1 | sed 's/^i/i-/g' | xclip -selection clipboard
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+Shift+v mode "$mode_paste"

# Bluetooth headset shortcuts
bindsym $mod+Shift+KP_Multiply exec --no-startup-id "echo -e \\"if echo -e 'info 10:4F:A8:F9:DA:74' | bluetoothctl | grep 'Connected: yes' &> /dev/null; then echo -e 'disconnect 10:4F:A8:F9:DA:74\nquit' | bluetoothctl; else echo -e 'connect 10:4F:A8:F9:DA:74\nquit' | bluetoothctl; fi\\" | bash"
bindsym $mod+Shift+KP_Divide exec --no-startup-id "echo -e \\"if pactl list | grep -A 7 'bluez.alias' | grep 'Active Profile' | grep 'a2dp_sink'; then pactl set-card-profile `pactl list | grep -B 6 'MDR-1000X' | grep 'Card' | grep -Eo '[0-9]+'` headset_head_unit; else pactl set-card-profile `pactl list | grep -B 6 'MDR-1000X' | grep 'Card' | grep -Eo '[0-9]+'` a2dp_sink; fi\\" | bash"
bindsym XF86AudioPlay exec playerctl play-pause
bindsym XF86AudioPause exec playerctl pause
bindsym XF86AudioNext exec playerctl next
bindsym XF86AudioPrev exec playerctl previous

# Bluetooth mode (for when working on laptop)
set $mode_bt Toggle connect headset (h), Switch BT profile (H)
mode "$mode_bt" {
    bindsym h exec --no-startup-id "echo -e \\"if echo -e 'info 10:4F:A8:F9:DA:74' | bluetoothctl | grep 'Connected: yes' &> /dev/null; then echo -e 'disconnect 10:4F:A8:F9:DA:74\nquit' | bluetoothctl; else echo -e 'connect 10:4F:A8:F9:DA:74\nquit' | bluetoothctl; fi\\" | bash"
    bindsym Shift+h exec --no-startup-id "echo -e \\"if pactl list | grep -A 7 'bluez.alias' | grep 'Active Profile' | grep 'a2dp_sink'; then pactl set-card-profile `pactl list | grep -B 6 'MDR-1000X' | grep 'Card' | grep -Eo '[0-9]+'` headset_head_unit; else pactl set-card-profile `pactl list | grep -B 6 'MDR-1000X' | grep 'Card' | grep -Eo '[0-9]+'` a2dp_sink; fi\\" | bash"

    # back to normal: Enter or Escape
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+Shift+F12 mode "$mode_bt"

# Volume control shortcuts
bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume $(pactl info | grep 'Default Sink:' | cut -d' ' -f3) +2% && pkill -RTMIN+10 i3blocks
bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume $(pactl info | grep 'Default Sink:' | cut -d' ' -f3) -2% && pkill -RTMIN+10 i3blocks
bindsym XF86AudioMute exec pactl set-sink-mute $(pactl info | grep 'Default Sink:' | cut -d' ' -f3) toggle && pkill -RTMIN+10 i3blocks
bindsym $mod+KP_Add exec --no-startup-id pactl set-sink-volume $(pactl info | grep 'Default Sink:' | cut -d' ' -f3) +2% && pkill -RTMIN+10 i3blocks
bindsym $mod+KP_Subtract exec --no-startup-id pactl set-sink-volume $(pactl info | grep 'Default Sink:' | cut -d' ' -f3) -2% && pkill -RTMIN+10 i3blocks
bindsym $mod+KP_Multiply exec --no-startup-id pactl set-sink-mute $(pactl info | grep 'Default Sink:' | cut -d' ' -f3) toggle && pkill -RTMIN+10 i3blocks

# Brightness control shortcuts
bindsym XF86MonBrightnessUp exec --no-startup-id light -A 2
bindsym XF86MonBrightnessDown exec --no-startup-id light -U 2

# Move workspace shortcuts
bindsym $mod+Shift+Mod1+Left move workspace to output left
bindsym $mod+Shift+Mod1+Right move workspace to output right

# Keepass autotype shortcut:
#bindsym $mod+Shift+a exec "keepass -auto-type-selected"

# Passmenu shortcut:
bindsym $mod+Shift+a exec "/home/alan/.config/rofi/scripts/passmenu"
bindsym $mod+Shift+s exec "/home/alan/.config/rofi/scripts/passmenu --type"
bindsym $mod+Shift+x exec "/home/alan/.config/rofi/scripts/awsmenu"

# launcher shortcuts
bindsym $mod+p exec i3finder
bindsym $mod+g exec i3finder -a move
bindsym $mod+b exec i3finder -a back

# autostart
# exec --no-startup-id setxkbmap -option ctrl:nocaps
exec --no-startup-id /usr/bin/lxsession
exec --no-startup-id libinput-gestures-setup start &
exec /usr/bin/nice -n 19 /usr/bin/slack
exec kitty --single-instance --session ~/.config/kitty/session-tmux.conf
exec libinput-gestures-setup start
exec /usr/bin/nice -n 19 /usr/bin/run_keybase
exec /usr/bin/xflux -l 51.9444199
exec /usr/bin/nm-applet
exec /usr/bin/blueman-applet
exec /usr/bin/waybar
exec /usr/bin/dunst

# Set window classes per workspace
assign [class="^Slack$"] → 1
assign [class="^Termite$"] → 2
assign [class="^st$"] → 2
assign [class="^st-256color$"] → 2
assign [class="^kitty$"] → 2
assign [class="sins of a solar empire rebellion.exe"] → 4
assign [window_role="^browser$"] → 3
# workaround for spotify not setting window hints correctly.
for_window [class="Spotify"] move to workspace 9
assign [class="^KeePass2$"] → 10

# Window tweaks
## Google Chrome
for_window [instance="^crx.*$" window_role="pop-up"]  floating enable
for_window [instance="^crx.*$" window_role="pop-up"]  sticky   enable

## Keybase
for_window [class="Keybase"] floating enable, move position mouse

# floating windows
for_window [window_role="pop-up"] floating enable
for_window [window_role="task_dialog"] floating enable

# sway specific options (disable if using i3)
output "*" background "/home/alan/.config/wallpaper" fill

output DP-1 {
  pos 0 1440 res 5120x1440@239.761002Hz
  scale 1
}

output DP-2 {
  pos 850 0 res 3440x1440@100Hz
}
